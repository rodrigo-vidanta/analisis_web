v2.2.0: Migración completa System_UI → PQNC_AI - Base de Datos Unificada

CAMBIO ARQUITECTÓNICO MAYOR
----------------------------

Unificación de bases de datos: System_UI + PQNC_AI → PQNC_AI (TODO en un proyecto)

MIGRACIÓN DE BASE DE DATOS
---------------------------
• 37 tablas migradas a PQNC_AI (glsmifhkoaifvaegsozd)
• 125 usuarios migrados
• ~8,500 registros totales
• 19 funciones RPC migradas
• 4 triggers migrados
• 5 vistas creadas (auth_user_profiles + 3 optimizadas)
• 8 tablas con realtime habilitado

TABLAS PRINCIPALES MIGRADAS
----------------------------
✅ auth_users, auth_roles, auth_sessions (autenticación)
✅ permissions, permission_groups (permisos)
✅ coordinaciones, auth_user_coordinaciones (coordinaciones)
✅ prospect_assignments, assignment_logs (asignaciones)
✅ user_notifications, admin_messages (notificaciones)
✅ content_moderation_warnings, user_warning_counters (moderación)
✅ api_auth_tokens, system_config, app_themes (configuración)
✅ bot_pause_status, uchat_conversations (UChat)
✅ whatsapp_*_labels (etiquetas)
✅ paraphrase_logs, auth_login_logs (logs)

FRONTEND ACTUALIZADO
--------------------
• 30 archivos modificados
• 10 servicios actualizados
• 3 hooks actualizados
• 8 componentes corregidos
• Eliminadas referencias a pqncSupabase (proyecto prohibido)
• Edge Functions configuradas correctamente

OPTIMIZACIONES
--------------
✅ Batch loading implementado
✅ Pre-carga de caché optimizada
✅ Vistas con JOINs creadas
✅ ERR_INSUFFICIENT_RESOURCES minimizado

ERRORES CORREGIDOS
------------------
• 16 errores críticos resueltos durante testing
• Foreign key embeds corregidos (10 archivos)
• Columnas inexistentes corregidas (6 archivos)
• Funciones RPC ajustadas
• Triggers migrados
• Vistas faltantes creadas

ARQUITECTURA FINAL
------------------
• PQNC_AI: Base de datos principal unificada
• System_UI: Solo backup y Edge Functions
• Beneficios: JOINs directos, menos requests, código más simple

DOCUMENTACIÓN
-------------
• 25+ documentos creados
• Documento maestro: docs/MIGRACION_SYSTEM_UI_A_PQNC_AI_COMPLETA.md
• Índice: INDICE_DOCUMENTACION_MIGRACION.md
• Arquitectura: docs/NUEVA_ARQUITECTURA_BD_UNIFICADA.md
• Reglas actualizadas en .cursor/rules/

TESTING
-------
✅ Login/Logout
✅ Dashboard Operativo
✅ Live Monitor/Llamadas IA
✅ WhatsApp/Live Chat
✅ Prospectos (Kanban y DataGrid)
✅ Admin → Preferencias, Coordinaciones, Dynamics CRM

ROLLBACK
--------
✅ .env.local.backup creado
✅ System_UI intacto como backup
✅ Tiempo de rollback: 5 minutos

---

Estado: MIGRACIÓN EXITOSA - 100% FUNCIONAL
Sin errores críticos
Listo para producción

Archivos modificados: 65
Scripts SQL generados: 20
Documentación generada: 25+

Breaking Changes: NINGUNO (compatible hacia atrás)
