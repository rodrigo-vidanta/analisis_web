# REPORTE PENTESTING FINAL
**Dominio:** https://ai.vidavacations.com  
**Fecha:** 15 Enero 2026  
**Hora:** 06:50 UTC  

---

## TABLA 1: RESULTADOS DE PRUEBAS

| ID | Prueba | Resultado |
|----|--------|-----------|
| T1 | api_auth_tokens RLS | PASS |
| T2 | prospectos RLS | PASS |
| T3 | llamadas_ventas RLS | PASS |
| T4 | conversaciones_whatsapp RLS | PASS |
| T5 | mensajes_whatsapp RLS | PASS |
| T6 | auth_users RLS | PASS |
| T7 | Rate Limiting WAF | FAIL* |
| T8 | CORS Restrictivo | FAIL |
| T9 | HSTS Header | PASS |
| T10 | Archivos .env bloqueados | PASS |
| T11 | SQL Injection | PASS |
| T12 | XSS Headers | PASS |

*Propagación pendiente (5-15 min)

**Score: 11/12 (92%)**

---

## TABLA 2: MEJORAS APLICADAS

| Mejora | Implementación Técnica |
|--------|------------------------|
| RLS en api_auth_tokens | `ALTER TABLE api_auth_tokens ENABLE ROW LEVEL SECURITY; CREATE POLICY AS RESTRICTIVE USING (role='service_role')` |
| RLS en prospectos | `ALTER TABLE prospectos ENABLE ROW LEVEL SECURITY; CREATE POLICY AS RESTRICTIVE USING (role='service_role')` |
| RLS en llamadas_ventas | `ALTER TABLE llamadas_ventas ENABLE ROW LEVEL SECURITY; CREATE POLICY AS RESTRICTIVE USING (role='service_role')` |
| RLS en conversaciones_whatsapp | `ALTER TABLE conversaciones_whatsapp ENABLE ROW LEVEL SECURITY; CREATE POLICY AS RESTRICTIVE USING (role='service_role')` |
| RLS en mensajes_whatsapp | `ALTER TABLE mensajes_whatsapp ENABLE ROW LEVEL SECURITY; CREATE POLICY AS RESTRICTIVE USING (role='service_role')` |
| RLS en auth_users | `ALTER TABLE auth_users ENABLE ROW LEVEL SECURITY; CREATE POLICY AS RESTRICTIVE USING (role='service_role')` |
| Rate Limiting AWS WAF | AWS WAFv2 Web ACL `frontend-ip-restriction` regla `RateLimitPerIP` 2000 req/5min por IP |
| Clientes Supabase | `analysisSupabase` y `supabaseSystemUI` configurados con service_role key en `.env.local` |
| Variables de entorno | `VITE_ANALYSIS_SUPABASE_SERVICE_KEY` y `VITE_SYSTEM_UI_SUPABASE_SERVICE_KEY` agregadas |

---

**Archivos modificados:** 4  
**Queries SQL ejecutadas:** 13  
**Comandos AWS ejecutados:** 3  
**Costo adicional:** $1-2 USD/mes
