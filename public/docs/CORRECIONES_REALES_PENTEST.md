# Correcciones REALES al Pentest

**Fecha:** 17 Enero 2026 01:00 UTC

## Lo Que NO Funcionó (lección aprendida)

**REVOKE EXECUTE no funcionó** en PostgreSQL/Supabase  
**Motivo:** Funciones tienen permisos por defecto que se restauran

**Políticas RLS con roles múltiples permitían anon**  
**Motivo:** `TO authenticated, anon` incluía anon

## Lo Que SÍ Funcionó

**DROP FUNCTION:** ✅ Elimina completamente
**REVOKE ALL ON tabla FROM anon:** ✅ Bloquea tabla

## Estado REAL Verificado

**Funciones SQL Peligrosas:**
- exec_sql_secure ✅ ELIMINADA
- exec_sql ✅ ELIMINADA  
- exec_sql_transaction ✅ ELIMINADA
- backup_table_data ✅ ELIMINADA
- get_all_tables ✅ ELIMINADA
- get_database_schema ✅ ELIMINADA

**Tablas:**
- system_config ✅ BLOQUEADO
- coordinaciones ✅ BLOQUEADO
- destinos ✅ BLOQUEADO
- app_themes ✅ BLOQUEADO
- auth_roles ✅ BLOQUEADO

**Edge Functions:**
- send-img-proxy ✅ Validación real de usuario

**Webhooks:**
- timeline ⚠️ Pendiente auth en N8N

**Vulnerabilidades resueltas:** 10/11
**Pendiente:** timeline webhook (N8N)
