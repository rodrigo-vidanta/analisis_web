# Handover: Deploy v2.5.47

**REF:** HANDOVER-2026-01-24-DEPLOY-v2.5.47  
**Fecha:** 2026-01-24  
**Commit:** 4c1b133  
**Versi√≥n:** B10.1.42N2.5.47

---

## üìã Resumen Ejecutivo

Fix de reasignaci√≥n de prospectos - eliminaci√≥n de actualizaciones duplicadas en base de datos. El frontend ahora solo env√≠a al webhook de N8N sin tocar la BD localmente.

---

## ‚úÖ Tareas Completadas

### 1. Actualizaci√≥n de C√≥digo

**Archivo principal modificado:**
- `src/services/dynamicsReasignacionService.ts`
  - Eliminada funci√≥n `actualizarLocalmente()` 
  - `reasignarProspecto()` ahora solo env√≠a al webhook sin actualizar BD
  - Actualizado header con documentaci√≥n correcta

**Cambio clave:**
```typescript
// ANTES: Despu√©s del webhook, actualizaba BD localmente
// AHORA: Solo env√≠a al webhook, N8N hace todo
async reasignarProspecto(request): Promise<ReasignacionResponse> {
  const webhookResponse = await this.enviarWebhook(request);
  if (!webhookResponse.success) return webhookResponse;
  
  // El workflow de N8N ya actualiz√≥ la BD
  return { success: true, ... };
}
```

### 2. Git Push
- Commit(s): f1b26ef, 14cf47b, 4c1b133
- Push a: origin/main

### 3. Deploy AWS
- Build: 18.98s
- URLs: 
  - S3: http://pqnc-qa-ai-frontend.s3-website.us-west-2.amazonaws.com
  - CloudFront: https://d3m6zgat40u0u1.cloudfront.net

### 4. Base de Datos
- ‚ö†Ô∏è **Requiere actualizaci√≥n manual**
- Tabla: system_config
- Config Key: app_version
- Valor a establecer:
```json
{
  "version": "B10.1.42N2.5.47",
  "force_update": true
}
```

**Comando SQL para actualizar:**
```sql
UPDATE system_config 
SET config_value = '{"version": "B10.1.42N2.5.47", "force_update": true}'::jsonb,
    updated_at = NOW()
WHERE config_key = 'app_version';
```

---

## üìä Cambios Principales

- ‚úÖ El frontend ya NO actualiza `prospectos` despu√©s de reasignar
- ‚úÖ El frontend ya NO actualiza `prospect_assignments` despu√©s de reasignar  
- ‚úÖ El frontend ya NO inserta en `assignment_logs` despu√©s de reasignar
- ‚úÖ Todo lo anterior ahora es responsabilidad exclusiva del workflow N8N
- ‚úÖ Eliminada duplicaci√≥n de trabajo entre frontend y N8N

---

## ‚è≠Ô∏è Pr√≥ximos Pasos

1. Esperar 5-10 min (propagaci√≥n CloudFront)
2. Limpiar cache navegador (Cmd+Shift+R)
3. Verificar versi√≥n en footer: B10.1.42N2.5.47
4. **Actualizar BD** con el comando SQL de arriba (si MCP no est√° disponible)
5. Probar reasignaci√≥n desde WhatsApp/Prospectos

---

## üìö Referencias

- Servicio modificado: `src/services/dynamicsReasignacionService.ts`
- Workflow N8N: `https://primary-dev-d75a.up.railway.app/webhook/reasignar-prospecto`
- Edge Function: `dynamics-reasignar-proxy`

---

**Deploy Status:** ‚úÖ COMPLETADO (BD pendiente de actualizaci√≥n manual)  
**Tiempo total:** ~2 minutos
