---
alwaysApply: true
---

# Reglas del MCP Supabase REST (Acceso Completo)

## üìã Informaci√≥n del MCP

| Propiedad | Valor |
|-----------|-------|
| **Nombre** | `SupabaseREST` |
| **Tipo** | Management API REST (Acceso Total) |
| **Token** | Personal Access Token (`.supabase/access_token`) |
| **Acceso** | **COMPLETO** - Todos los proyectos y operaciones |
| **Documentaci√≥n** | `docs/MCP_REST_FULL_ACCESS.md` |

## ‚ö° Capacidades

‚úÖ **Multi-Proyecto:** Listar y cambiar entre proyectos  
‚úÖ **SQL Completo:** SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, ALTER  
‚úÖ **DDL:** Crear/modificar tablas, funciones, triggers  
‚úÖ **Sin Restricciones:** Acceso total a Management API

## üîß Herramientas Disponibles

### Gesti√≥n de Proyectos

```typescript
mcp_SupabaseREST_list_projects()           // üìã Listar proyectos
mcp_SupabaseREST_switch_project({          // üîÑ Cambiar proyecto
  projectId: "glsmifhkoaifvaegsozd"
})
mcp_SupabaseREST_get_current_project()     // üìç Ver proyecto actual
```

### SQL Arbitrario

```typescript
mcp_SupabaseREST_execute_sql({
  sql: "SELECT * FROM auth_users LIMIT 5",
  description: "Listar usuarios"
})

// DDL
mcp_SupabaseREST_execute_sql({
  sql: `
    CREATE TABLE test (
      id UUID PRIMARY KEY,
      name TEXT
    )
  `,
  description: "Crear tabla"
})
```

### Operaciones CRUD

```typescript
mcp_SupabaseREST_query_table({
  table: "prospectos",
  select: "id, nombre, telefono",
  filter: { status: "activo" },
  limit: 50,
  order: "created_at DESC"
})

mcp_SupabaseREST_insert_data({
  table: "coordinaciones",
  data: { nombre: "CDMX Sur", codigo: "CDMX-S" }
})

mcp_SupabaseREST_update_data({
  table: "prospectos",
  data: { status: "contactado" },
  filter: { id: "uuid-aqui" }
})

mcp_SupabaseREST_delete_data({
  table: "test_data",
  filter: { id: "uuid-aqui" }
})
```

### Utilidades

```typescript
mcp_SupabaseREST_get_schema()              // Ver estructura BD
mcp_SupabaseREST_get_table_info({          // Detalles de tabla
  table: "prospectos"
})
mcp_SupabaseREST_backup_table({            // Backup JSON
  table: "coordinaciones"
})
mcp_SupabaseREST_debug_connection()        // Test conexi√≥n
```

## ‚ö†Ô∏è Seguridad

### üî¥ Riesgos

Este MCP tiene **ACCESO TOTAL**:
- Puede eliminar proyectos
- Puede modificar billing
- Puede ejecutar DROP DATABASE
- Sin auditor√≠a de operaciones

### ‚úÖ Uso Seguro

- **SOLO** en computadora personal
- Token en `.supabase/access_token` (chmod 600)
- **NUNCA** subir a Git
- **NUNCA** compartir token
- Para **desarrollo local** √∫nicamente

## üöÄ Setup R√°pido

```bash
# 1. Crear token en: https://supabase.com/dashboard/account/tokens

# 2. Guardar token
echo "sbp_tu_token" > .supabase/access_token
chmod 600 .supabase/access_token
echo ".supabase/access_token" >> .gitignore

# 3. Configurar ~/.cursor/mcp.json
{
  "mcpServers": {
    "SupabaseREST": {
      "command": "npx",
      "args": ["-y", "tsx", "/ruta/completa/mcp-supabase-rest-server.ts"],
      "env": {
        "SUPABASE_PROJECT_ID": "glsmifhkoaifvaegsozd"
      }
    }
  }
}

# 4. Reiniciar Cursor (Cmd+Q)
```

## üîç Troubleshooting

### MCP no aparece en Cursor

```bash
# 1. Limpiar cache
rm -rf ~/.cursor/projects/.../mcps/user-SupabaseREST/

# 2. Verificar token
cat .supabase/access_token

# 3. Test manual
echo '{"jsonrpc":"2.0","id":1,"method":"initialize","params":{"protocolVersion":"2024-11-05","capabilities":{},"clientInfo":{"name":"test","version":"1.0.0"}}}' | \
SUPABASE_PROJECT_ID=glsmifhkoaifvaegsozd npx -y tsx mcp-supabase-rest-server.ts

# 4. Reiniciar Cursor completamente
```

### Token inv√°lido

1. Ir a https://supabase.com/dashboard/account/tokens
2. Revocar token antiguo
3. Generar nuevo token
4. Actualizar `.supabase/access_token`

## üìö Ver Tambi√©n

- [Documentaci√≥n Completa](../docs/MCP_REST_FULL_ACCESS.md)
- [MCP Secure Proxy](../docs/MCP_SECURE_PROXY_SETUP.md) - Alternativa segura para producci√≥n
- [Security Rules](security-rules.mdc)

---

**√öltima actualizaci√≥n:** 24 de Enero 2026  
**Estado:** ‚úÖ Funcional - Desarrollo Local
