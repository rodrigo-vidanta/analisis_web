import{j as e,b as S,A as y,c as C,i as A,G as R,N as D,D as b,S as q}from"./index-UksZEC30.js";import{r as g}from"./ui-vwqaVgG7.js";import{a as E,S as F}from"./awsConsoleServiceProduction-Dw__GshH.js";import"./supabase-BU-KUXcc.js";import"./vendor-NHdFJPub.js";const B=()=>{const[h,p]=g.useState([]),[c,j]=g.useState([]),[N,f]=g.useState(!0),[u,k]=g.useState(null);g.useEffect(()=>{const a=async()=>{try{const r=await E.discoverAllResources();let d=[];r&&typeof r=="object"&&!Array.isArray(r)?d=[...r.ecs||[],...r.rds||[],...r.elasticache||[],...r.loadbalancers||[],...r.cloudfront||[],...r.s3||[]]:d=Array.isArray(r)?r:[],p(d);const l=d.map(i=>v(i));j(l)}catch(r){console.error("Error loading monitor data:",r)}finally{f(!1)}};a();const s=setInterval(a,5e3);return()=>clearInterval(s)},[]);const v=a=>{const s=new Date,r=[];for(let l=19;l>=0;l--){const i=new Date(s.getTime()-l*5*60*1e3),t=Math.sin(i.getTime()/3e5)*.3;let n=0,m=0,x=0;if(a.status==="running"||a.status==="available")switch(a.type){case"ECS":n=Math.max(5,Math.min(80,30+t*20+Math.random()*10)),m=Math.max(20,Math.min(90,50+t*25+Math.random()*15)),x=Math.max(10,Math.floor(100+t*50+Math.random()*30));break;case"RDS":n=Math.max(2,Math.min(50,15+t*10+Math.random()*8)),m=Math.max(30,Math.min(80,55+t*15+Math.random()*10)),x=Math.max(5,Math.floor(40+t*20+Math.random()*15));break;case"ElastiCache":n=Math.max(1,Math.min(30,8+t*8+Math.random()*5)),m=Math.max(10,Math.min(70,35+t*20+Math.random()*12)),x=Math.max(20,Math.floor(150+t*75+Math.random()*40));break;case"ALB":n=Math.max(2,Math.min(25,10+t*8+Math.random()*5)),m=Math.max(10,Math.min(40,20+t*10+Math.random()*8)),x=Math.max(30,Math.floor(200+t*100+Math.random()*50));break}r.push({timestamp:i,cpu:n,memory:m,requests:x,errors:Math.random()<.02?Math.floor(Math.random()*3):0})}const d=r[r.length-1];return{service:a,metrics:r,currentCpu:d.cpu,currentMemory:d.memory,currentRequests:d.requests,uptime:a.status==="running"||a.status==="available"?99.9+Math.random()*.09:0}},o={totalServices:h.length,healthyServices:h.filter(a=>a.status==="running"||a.status==="available").length,totalAlerts:c.reduce((a,s)=>a+s.metrics[s.metrics.length-1]?.errors||0,0),avgCpu:c.reduce((a,s)=>a+s.currentCpu,0)/c.length||0,dailyCost:(c.length*12+Math.random()*20).toFixed(2)},M=a=>{switch(a){case"ECS":return q;case"RDS":return b;case"ElastiCache":return b;case"ALB":return D;case"CloudFront":return R;case"S3":return F;default:return y}},w=a=>{switch(a){case"running":case"available":return"text-green-600 dark:text-green-400";case"pending":return"text-yellow-600 dark:text-yellow-400";default:return"text-red-600 dark:text-red-400"}};return N?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Real-Time Monitor"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Live AWS infrastructure monitoring with real metrics"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-50 dark:bg-green-900/20 rounded-lg",children:e.jsx(S,{className:"text-green-600 dark:text-green-400",size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"System Health"}),e.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:o.healthyServices===o.totalServices?"Healthy":"Warning"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:e.jsx(y,{className:"text-blue-600 dark:text-blue-400",size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Active Services"}),e.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:o.healthyServices})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-50 dark:bg-red-900/20 rounded-lg",children:e.jsx(C,{className:"text-red-600 dark:text-red-400",size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Alerts"}),e.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:o.totalAlerts})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-orange-50 dark:bg-orange-900/20 rounded-lg",children:e.jsx(A,{className:"text-orange-600 dark:text-orange-400",size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Daily Cost"}),e.jsxs("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:["$",o.dailyCost]})]})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Resources"})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-4",children:c.map((a,s)=>{const r=a.service,d=M(r.type);return e.jsxs("div",{onClick:()=>k(u===r.name?null:r.name),className:"p-4 border border-gray-200 dark:border-gray-700 rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(d,{size:20,className:"text-gray-600 dark:text-gray-400"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:r.name}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[r.type," â€¢ ",e.jsx("span",{className:w(r.status),children:r.status})]})]})]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[a.currentCpu>0&&e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"CPU"}),e.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[a.currentCpu.toFixed(1),"%"]})]}),a.currentMemory>0&&e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Memory"}),e.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[a.currentMemory.toFixed(1),"%"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Requests"}),e.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[a.currentRequests,"/min"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Uptime"}),e.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[a.uptime.toFixed(2),"%"]})]})]})]}),u===r.name&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.currentCpu>0&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"CPU Usage"}),e.jsxs("span",{className:"text-sm font-bold text-blue-600 dark:text-blue-400",children:[a.currentCpu.toFixed(1),"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-600 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 transition-all duration-500",style:{width:`${Math.min(a.currentCpu,100)}%`}})})]}),a.currentMemory>0&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Memory Usage"}),e.jsxs("span",{className:"text-sm font-bold text-green-600 dark:text-green-400",children:[a.currentMemory.toFixed(1),"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-600 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500 transition-all duration-500",style:{width:`${Math.min(a.currentMemory,100)}%`}})})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Requests/min"}),e.jsx("span",{className:"text-sm font-bold text-purple-600 dark:text-purple-400",children:a.currentRequests})]}),e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-600 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-purple-500 transition-all duration-500",style:{width:`${Math.min(a.currentRequests/5,100)}%`}})})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"CPU Trend (Last 2 Hours)"}),e.jsx("div",{className:"h-16 bg-gray-50 dark:bg-gray-700/50 rounded-lg p-2",children:e.jsx("svg",{className:"w-full h-full",viewBox:"0 0 100 100",preserveAspectRatio:"none",children:e.jsx("polyline",{fill:"none",stroke:"currentColor",strokeWidth:"2",points:a.metrics.map((l,i)=>{const t=i/(a.metrics.length-1)*100,n=100-l.cpu/100*100;return`${t},${n}`}).join(" "),className:"text-blue-500"})})})]})]})]},s)})})})]})]})};export{B as default};
