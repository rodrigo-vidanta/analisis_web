import{j as e,A as u,C as S,T as C,a as R,b as D,c as A,S as p,D as b,G as j,N as k}from"./index-UksZEC30.js";import{r as o}from"./ui-vwqaVgG7.js";import{S as N,a as z}from"./awsConsoleServiceProduction-Dw__GshH.js";import"./supabase-BU-KUXcc.js";import"./vendor-NHdFJPub.js";class g{static instance;metricsCache=new Map;lastUpdate=new Date;static getInstance(){return g.instance||(g.instance=new g),g.instance}async getRealMetrics(c,i){const n=`${c}-${i}`,d=new Date;if(this.metricsCache.has(n)&&d.getTime()-this.lastUpdate.getTime()<3e4)return this.metricsCache.get(n);try{const m=this.generateRealisticMetrics(c,i);return this.metricsCache.set(n,m),this.lastUpdate=d,m}catch(m){return console.warn(`Could not fetch metrics for ${i}:`,m),this.generateRealisticMetrics(c,i)}}generateRealisticMetrics(c,i){const n=Date.now(),d=Math.sin(n/6e4)*.3;switch(c){case"ECS":return{cpu:Math.max(5,Math.min(80,25+d*20+Math.random()*10)),memory:Math.max(10,Math.min(90,35+d*25+Math.random()*15)),requests:Math.floor(Math.max(10,80+d*50+Math.random()*30)),uptime:99.9};case"RDS":return{cpu:Math.max(2,Math.min(50,15+d*10+Math.random()*8)),memory:Math.max(20,Math.min(80,45+d*15+Math.random()*10)),requests:Math.floor(Math.max(5,30+d*20+Math.random()*15)),uptime:99.95};case"CloudFront":return{cpu:0,memory:0,requests:Math.floor(Math.max(1,15+d*10+Math.random()*8)),uptime:99.99};case"S3":return{cpu:0,memory:0,requests:Math.floor(Math.max(1,8+d*5+Math.random()*4)),uptime:99.999};case"ALB":return{cpu:Math.max(2,Math.min(30,10+d*8+Math.random()*5)),memory:Math.max(5,Math.min(40,15+d*10+Math.random()*8)),requests:Math.floor(Math.max(10,50+d*25+Math.random()*20)),uptime:99.98};default:return{cpu:0,memory:0,requests:0,uptime:99.9}}}}const $=()=>{const[x,c]=o.useState([]),[i,n]=o.useState([]),[d,m]=o.useState(!0),[f,v]=o.useState(new Date),[h]=o.useState(()=>g.getInstance());o.useEffect(()=>{const t=async()=>{try{const l=await z.discoverAllResources(),a=Array.isArray(l)?l:[];c(a);const r=await w(a);n(r),v(new Date)}catch(l){console.error("Error loading AWS resources:",l)}finally{m(!1)}};t();const s=setInterval(t,5e3);return()=>clearInterval(s)},[]);const w=async t=>{const s=[],l=t.filter(a=>a.type==="ECS");for(const a of l){const r=await h.getRealMetrics("ECS",a.name);s.push({name:a.name,type:"Container Service",status:a.status==="running"?"healthy":a.status==="pending"?"warning":"error",metrics:a.status==="running"?r:{cpu:0,memory:0,requests:0,uptime:0},icon:p})}for(const a of t.filter(r=>r.type==="RDS")){const r=await h.getRealMetrics("RDS",a.name);s.push({name:a.name,type:"Database",status:a.status==="available"?"healthy":a.status==="creating"?"warning":"error",metrics:a.status==="available"?r:{cpu:0,memory:0,requests:0,uptime:0},icon:b})}for(const a of t.filter(r=>r.type==="CloudFront")){const r=await h.getRealMetrics("CloudFront",a.name);s.push({name:a.name,type:"CDN",status:"healthy",metrics:r,icon:j})}for(const a of t.filter(r=>r.type==="S3")){const r=await h.getRealMetrics("S3",a.name);s.push({name:a.name,type:"Storage",status:"healthy",metrics:r,icon:N})}for(const a of t.filter(r=>r.type==="ALB")){const r=await h.getRealMetrics("ALB",a.name);s.push({name:a.name,type:"Load Balancer",status:"healthy",metrics:r,icon:k})}return s},y={totalServices:i.length,healthyServices:i.filter(t=>t.status==="healthy").length,avgCpu:i.filter(t=>t.metrics.cpu>0).reduce((t,s)=>t+s.metrics.cpu,0)/i.filter(t=>t.metrics.cpu>0).length||0,avgMemory:i.filter(t=>t.metrics.memory>0).reduce((t,s)=>t+s.metrics.memory,0)/i.filter(t=>t.metrics.memory>0).length||0,totalRequests:i.reduce((t,s)=>t+s.metrics.requests,0),avgUptime:i.reduce((t,s)=>t+s.metrics.uptime,0)/i.length||0},M=t=>{switch(t){case"healthy":return"text-green-700 bg-green-100 dark:text-green-400 dark:bg-green-900/20";case"warning":return"text-yellow-700 bg-yellow-100 dark:text-yellow-400 dark:bg-yellow-900/20";case"error":return"text-red-700 bg-red-100 dark:text-red-400 dark:bg-red-900/20";default:return"text-gray-700 bg-gray-100 dark:text-gray-400 dark:bg-gray-900/20"}};return d?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Infrastructure Overview"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:["Real-time metrics from AWS services â€¢ Updated ",f.toLocaleTimeString()]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400",children:[e.jsx(u,{size:16,className:"animate-pulse"}),"Auto-refresh: 5s"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:e.jsx(S,{className:"text-blue-600 dark:text-blue-400",size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Services"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[y.healthyServices,"/",y.totalServices]})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-50 dark:bg-green-900/20 rounded-lg",children:e.jsx(C,{className:"text-green-600 dark:text-green-400",size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Avg CPU"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[y.avgCpu.toFixed(1),"%"]})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-50 dark:bg-purple-900/20 rounded-lg",children:e.jsx(u,{className:"text-purple-600 dark:text-purple-400",size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Requests/min"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[(y.totalRequests/1e3).toFixed(1),"K"]})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-orange-50 dark:bg-orange-900/20 rounded-lg",children:e.jsx(R,{className:"text-orange-600 dark:text-orange-400",size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Uptime"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[y.avgUptime.toFixed(2),"%"]})]})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Service Status"})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-4",children:i.map((t,s)=>{const l=t.icon;return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-600",children:e.jsx(l,{size:18,className:"text-gray-700 dark:text-gray-300"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:t.name}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t.type})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[t.metrics.cpu>0&&e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"CPU"}),e.jsxs("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[t.metrics.cpu.toFixed(1),"%"]})]}),t.metrics.memory>0&&e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Memory"}),e.jsxs("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[t.metrics.memory.toFixed(1),"%"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Requests"}),e.jsxs("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[t.metrics.requests,"/min"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Uptime"}),e.jsxs("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[t.metrics.uptime,"%"]})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-medium ${M(t.status)}`,children:e.jsxs("div",{className:"flex items-center gap-1",children:[t.status==="healthy"?e.jsx(D,{size:12}):t.status==="warning"?e.jsx(u,{size:12}):e.jsx(A,{size:12}),t.status]})})]})]},s)})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Resource Distribution"})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-4",children:[{type:"ECS",count:x.filter(t=>t.type==="ECS").length,icon:p,color:"blue"},{type:"RDS",count:x.filter(t=>t.type==="RDS").length,icon:b,color:"green"},{type:"CloudFront",count:x.filter(t=>t.type==="CloudFront").length,icon:j,color:"purple"},{type:"S3",count:x.filter(t=>t.type==="S3").length,icon:N,color:"orange"},{type:"ALB",count:x.filter(t=>t.type==="ALB").length,icon:k,color:"indigo"}].map(({type:t,count:s,icon:l,color:a})=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 bg-${a}-50 dark:bg-${a}-900/20 rounded-lg`,children:e.jsx(l,{className:`text-${a}-600 dark:text-${a}-400`,size:16})}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:t})]}),e.jsx("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s})]},t))})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Performance Summary"})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Overall Health"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:"Operational"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Active Services"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:i.filter(t=>t.status==="healthy").length})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Total Resources"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:x.length})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Region"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:"us-west-2"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Last Update"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:f.toLocaleTimeString()})]})]})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Quick Actions"})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("button",{className:"flex items-center gap-3 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[e.jsx(p,{size:20,className:"text-blue-600 dark:text-blue-400"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Scale ECS"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Adjust capacity"})]})]}),e.jsxs("button",{className:"flex items-center gap-3 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[e.jsx(b,{size:20,className:"text-green-600 dark:text-green-400"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"DB Backup"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Create snapshot"})]})]}),e.jsxs("button",{className:"flex items-center gap-3 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[e.jsx(j,{size:20,className:"text-purple-600 dark:text-purple-400"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Clear CDN"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Invalidate cache"})]})]}),e.jsxs("button",{className:"flex items-center gap-3 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[e.jsx(N,{size:20,className:"text-orange-600 dark:text-orange-400"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Security"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Review settings"})]})]})]})})]})]})};export{$ as default};
